# Jeffley GArçon 2311100023 & Loude Djema Sime 2211100051
.data
prompt_menu: .asciz "Menu Principal:\n1. Configuracao\n2. Jogar\n3. Sair\nEscolha: "
prompt_config:  .asciz "\nMenu de Configuracao:\n1. Quantidade de jogadores\n2. Tamanho do tabuleiro\n3. Modo de dificuldade\n4. Zerar contadores\n5. Mostrar configuracoes\n6. Voltar ao Menu Principal\nEscolha: "
opcao_invalida: .asciz "Opcao invalida, tente novamente.\n"
qtd_jogadores_msg: .asciz "Quantidade de jogadores (1 ou 2): "
msg_de_um_jogador: .asciz " 1 Jogador \n--------------------------------\n"
msg_de_dois_jogador: .asciz " 2 Jogadores \n--------------------------------\n"
tamanho_tabuleiro_msg: .asciz "Tamanho do tabuleiro\n1. para 7x6 \n, \n2 para 9x6 \n "
msg_7x6_escolhido: .asciz "Tabuleiro 7x6 escolhido.\n--------------------------------\n"
msg_9x6_escolhido: .asciz "Tabuleiro 9x6 escolhido.\n --------------------------------\n"
modo_dificuldade_msg: .asciz "Modo de dificuldade (1 - Facil, 2 - Medio): \n.1. Facil\n2. Medio\n--------------------------------\n"
msg_modo_facil: .asciz "Modo Facil escolhido.\n--------------------------------\n"
msg_modo_medio: .asciz "Modo Medio escolhido.\n--------------------------------\n"
contadores_zerados_msg: .asciz "Contadores zerados.\n--------------------------------\n"
mostrar_config_msg: .asciz "Configuracao atual.\n"
config_jogadores_msg: .asciz "\nQuantidade de jogadores: "
config_tamanho_tabuleiro_msg: .asciz "\nTamanho do tabuleiro: "
config_modo_dificuldade_msg: .asciz "\nModo de dificuldade: "
config_contadores_msg: .asciz "\nContadores:\nTotal jogadas: "
config_vitorias_msg: .asciz "\nVitorias: "
config_derrotas_msg: .asciz "\nDerrotas: "
msg_jogo_iniciado: .asciz "Iniciando o jogo...\n"
msg_tabuleiro_inicializado: .asciz "Tabuleiro inicializado com sucesso.\n"
msg_selecione_coluna: .asciz "Selecione uma coluna (0 a 5): "
msg_jogador1: .asciz "Jogador 1 (X), selecione sua jogada.\n"
msg_jogador2: .asciz "Jogador 2 (O), selecione sua jogada.\n"
msg_jogada_invalida: .asciz "Jogada invalida, tente novamente.\n"
msg_vitoria_jogador1: .asciz "Jogador 1 (X) venceu!\n"
msg_vitoria_jogador2: .asciz "Jogador 2 (O) venceu!\n"
msg_empate: .asciz "Empate!\n"
msg_coluna_invalida: .asciz "Coluna inv�lida, tente novamente.\n"
newline: .asciz "\n" 
contador_total_jogadas: .word 0 
contador_vitorias: .word 0
contador_derrotas: .word 0 

tabuleiro: 
    .word 0, 0, 0, 0, 0, 0, 0
    .word 0, 0, 0, 0, 0, 0, 0
    .word 0, 0, 0, 0, 0, 0, 0
    .word 0, 0, 0, 0, 0, 0, 0
    .word 0, 0, 0, 0, 0, 0, 0
    .word 0, 0, 0, 0, 0, 0, 0
    
col_header: .asciz "0 1 2 3 4 5 6\n"

.text
.globl main
main:

    li a7, 4                       
    la a0, prompt_menu             
    ecall                          


    li a7, 5                       
    ecall                        
    mv t0, a0                    


    li t1, 1                       
    beq t0, t1, configuracao       

    li t1, 2                       
    beq t0, t1, jogar              

    li t1, 3                     
    beq t0, t1, sair               


    li a7, 4                       
    la a0, opcao_invalida          
    ecall                          
    j main                         

configuracao:
    li a7, 4                       
    la a0, prompt_config           
    ecall

    li a7, 5                       
    ecall
    mv t1, a0


    li t2, 1                      
    beq t1, t2, qtd_jogadores

    li t2, 2                      
    beq t1, t2, tamanho_tabuleiro

    li t2, 3                       
    beq t1, t2, modo_dificuldade

    li t2, 4                      
    beq t1, t2, zerar_contadores

    li t2, 5                       
    beq t1, t2, mostrar_configuracoes
    
    li t2, 6
    beq t1, t2, main

    j configuracao                 

qtd_jogadores:
    li a7, 4
    la a0, qtd_jogadores_msg
    ecall                         

    li a7, 5                     
    ecall                         

    li t3, 10                      
    beq a0, t3, qtd_jogadores      

    li t1, 1                    
    li t2, 2                    
    beq a0, t1, um_jogador        
    beq a0, t2, dois_jogadores    

    li a7, 4
    la a0, opcao_invalida        
    ecall
    j qtd_jogadores             
um_jogador:
    li s0, 1                       
    li a7, 4                       
    la a0, msg_de_um_jogador      
    ecall
    j configuracao

dois_jogadores:
    li s0, 2 
    li a7, 4                       
    la a0, msg_de_dois_jogador
    ecall
    j configuracao



tamanho_tabuleiro:
    li a7, 4
    la a0, tamanho_tabuleiro_msg
    ecall 

    li a7, 5 
    ecall
    mv t1, a0

    li t2, 1 
    beq t1, t2, tabuleiro_7x6

    li t2, 2 
    beq t1, t2, tabuleiro_9x6

    li a7, 4
    la a0, opcao_invalida
    ecall
    j tamanho_tabuleiro

tabuleiro_7x6:
    li s1, 1 
    li a7, 4
    la a0, msg_7x6_escolhido
    ecall
    j configuracao

tabuleiro_9x6:
    li s1, 2 
    li a7, 4
    la a0, msg_9x6_escolhido
    ecall
    j configuracao
    
modo_dificuldade:
    li a7, 4
    la a0, modo_dificuldade_msg
    ecall

    li a7, 5
    ecall
    mv t1, a0

    li t2, 1
    beq t1, t2, modo_facil

    li t2, 2 
    beq t1, t2, modo_medio

    li a7, 4
    la a0, opcao_invalida
    ecall
    j modo_dificuldade

modo_facil:
    li s2, 1 
    li a7, 4
    la a0, msg_modo_facil
    ecall
    j configuracao

modo_medio:
    li s2, 2 
    li a7, 4
    la a0, msg_modo_medio
    ecall
    j configuracao

zerar_contadores:
    li a0, 0
    la t0, contador_total_jogadas
    sw a0, 0(t0) 

    la t0, contador_vitorias
    sw a0, 0(t0)

    la t0, contador_derrotas
    sw a0, 0(t0)


    li a7, 4
    la a0, contadores_zerados_msg  
    ecall
    j configuracao

mostrar_configuracoes:

    li a7, 4
    la a0, mostrar_config_msg      
    ecall

    li a7, 4
    la a0, config_jogadores_msg    
    ecall
    li a7, 1
    mv a0, s0
    ecall

    li a7, 4
    la a0, config_tamanho_tabuleiro_msg
    ecall
    li a7, 1
    mv a0, s1
    ecall

    li a7, 4
    la a0, config_modo_dificuldade_msg
    ecall
    li a7, 1
    mv a0, s2
    ecall

    li a7, 4
    la a0, config_contadores_msg
    ecall

    li a7, 1
    la t0, contador_total_jogadas
    lw a0, 0(t0)
    ecall

    li a7, 4
    la a0, config_vitorias_msg
    ecall
    li a7, 1
    la t0, contador_vitorias
    lw a0, 0(t0) 
    ecall

    li a7, 4
    la a0, config_derrotas_msg
    ecall
    li a7, 1
    la t0, contador_derrotas
    lw a0, 0(t0) 
    ecall

    j configuracao


jogar:
    jal inicializa_tabuleiro
    li s3, 0

loop_jogo:
    jal imprime_tabuleiro

    beqz s3, turno_jogador1
    jal turno_jogador2

    jal verifica_vencedor
    j loop_jogo

verifica_vencedor:
    jr ra

turno_jogador1:
    li a7, 4
    la a0, msg_jogador1
    ecall

    jal selecionar_coluna
    mv t2, a0

    jal insere_peca
    li s3, 1
    jr ra

turno_jogador2:
    li a7, 4
    la a0, msg_jogador2
    ecall

    jal selecionar_coluna
    mv t2, a0

    jal insere_peca
    li s3, 0
    jr ra

selecionar_coluna:
    li a7, 4
    la a0, msg_selecione_coluna
    ecall

    li a7, 5
    ecall

    li t1, 0
    li t2, 5
    blt a0, t1, coluna_invalida
    bgt a0, t2, coluna_invalida

    mv t2, a0
    jr ra

coluna_invalida:
    li a7, 4
    la a0, msg_coluna_invalida
    ecall
    j selecionar_coluna

insere_peca:
    li t3, 6
    la t4, tabuleiro
    mul t5, t2, t3
    add t4, t4, t5
    li t6, 0

loop_insere:
    lw t6, 0(t4)
    beqz t6, coloca_peca
    addi t4, t4, 4
    addi t6, t6, 1
    blt t6, t3, loop_insere
    j coluna_cheia

coloca_peca:
    beqz s3, jogador1_peca
    li t6, 2
    sw t6, 0(t4)
    jr ra

jogador1_peca:
    li t6, 1
    sw t6, 0(t4)
    jr ra

coluna_cheia:
    li a7, 4
    la a0, msg_coluna_invalida
    ecall
    j selecionar_coluna

verifica_vitoria:
    jr ra

inicializa_tabuleiro:
    la t2, tabuleiro
    li t0, 6
    li t1, 7
    
imprime_tabuleiro:
    li a7, 4
    la a0, col_header
    ecall

    la t0, tabuleiro
    li t1, 6
    li t2, 7

imprime_linhas:
    li t3, 0

imprime_colunas:
    lw t4, 0(t0)
    li t5, 0

    beq t4, t5, imprime_vazio
    li t5, 1
    beq t4, t5, imprime_jogador1

    li t5, 2
    beq t4, t5, imprime_jogador2

imprime_vazio:
    li a7, 4
    la a0, dash
    ecall
    j proxima_celula

imprime_jogador1:
    li a7, 4
    la a0, jogador1_peca
    ecall
    j proxima_celula

imprime_jogador2:
    li a7, 4
    la a0, jogador2_peca
    ecall
    j proxima_celula

proxima_celula:
    addi t0, t0, 4
    addi t3, t3, 1
    blt t3, t2, imprime_colunas

    li a7, 4
    la a0, newline
    ecall

    addi t1, t1, -1
    bgtz t1, imprime_linhas
    jr ra


sair:
    li a7, 10                    
    ecall

.data
dash: .asciz "- "
jogador2_peca: .asciz "& "
